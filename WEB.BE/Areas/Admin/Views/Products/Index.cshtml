@model WEB.BE.Models.ViewModels.ProductSearchVM

@{
    ViewBag.Title = "Quản lý sản phẩm";
    Layout = "~/Areas/Admin/Views/Shared/_AdminLayout.cshtml";
}

<h2 class="text-center text-primary mt-3 bg-danger text-white">QUẢN LÝ HÀNG HÓA</h2>
<hr />

<!-- Form tìm kiếm -->
@using (Html.BeginForm("Index", "Products", FormMethod.Get))
{
    <div class="row mb-3">

        <div class="col-md-4">
            @Html.TextBoxFor(m => m.SearchTerm, new
            {
                @class = "form-control",
                placeholder = "Nhập tên, mô tả hoặc chủng loại..."
            })
        </div>

        <div class="col-md-2">
            @Html.TextBoxFor(m => m.MinPrice, new
            {
                @class = "form-control",
                type = "number",
                placeholder = "Giá tối thiểu"
            })
        </div>

        <div class="col-md-2">
            @Html.TextBoxFor(m => m.MaxPrice, new
            {
                @class = "form-control",
                type = "number",
                placeholder = "Giá tối đa"
            })
        </div>

        <div class="col-md-2">
            <button type="submit" class="btn btn-primary w-100">
                Tìm kiếm
            </button>
        </div>

        <div class="col-md-2">
            <a href="@Url.Action("Index")" class="btn btn-secondary w-100">
                Reset
            </a>
        </div>

    </div>

    <!-- Sắp xếp -->
    <div class="mb-3 text-center">
        <strong>Sắp xếp:</strong>
        @Html.ActionLink("Tên ↑", "Index", new { sortOrder = "name_asc", searchTerm = Model.SearchTerm }) |
        @Html.ActionLink("Tên ↓", "Index", new { sortOrder = "name_desc", searchTerm = Model.SearchTerm }) |
        @Html.ActionLink("Giá ↑", "Index", new { sortOrder = "price_asc", searchTerm = Model.SearchTerm }) |
        @Html.ActionLink("Giá ↓", "Index", new { sortOrder = "price_desc", searchTerm = Model.SearchTerm })
    </div>
}

<!-- Bảng danh sách sản phẩm đúng chuẩn -->
<table class="table table-bordered table-hover text-center align-middle">
    <thead class="table-dark">
        <tr>
            <th>Ảnh</th>
            <th>Tên sản phẩm</th>
            <th>Giá</th>
            <th>Tồn kho</th>
            <th>Chủng loại</th>
            <th style="width:160px;">Chức năng</th>
        </tr>
    </thead>

    <tbody>
        @if (Model.Products != null && Model.Products.Any())
        {
            foreach (var item in Model.Products)
            {
                <tr>
                    <td>
                        <img src="~/Images/@item.ProductImage" width="70" height="70" style="object-fit:cover;" />
                    </td>
                    <td>@item.ProductName</td>
                    <td>@item.ProductPrice.ToString("N0") VNĐ</td>
                    <td>@item.Quantity</td>
                    <td> @item.Category.CategoryName</td>      


                    <td>
                        @Html.ActionLink("Chi tiết", "Details", new { id = item.ProductID }, new { @class = "btn btn-info btn-sm" })
                        @Html.ActionLink("Sửa", "Edit", new { id = item.ProductID }, new { @class = "btn btn-warning btn-sm" })
                        @Html.ActionLink("Xóa", "Delete", new { id = item.ProductID }, new { @class = "btn btn-danger btn-sm" })
                    </td>
                </tr>
            }
        }
        else
        {
            <tr>
                <td colspan="6" class="text-danger">
                    Không tìm thấy sản phẩm nào phù hợp!
                </td>
            </tr>
        }
    </tbody>
</table>

<a href="@Url.Action("Create", "Products")" class="btn btn-success">
    + Thêm sản phẩm mới
</a>
